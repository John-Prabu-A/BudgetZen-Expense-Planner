// /**
//  * Integration Example: Using Transaction Detection Service
//  * 
//  * This file demonstrates how to integrate the transaction detection service
//  * into your app at different levels.
//  * 
//  * NOTE: This is example code. Copy/adapt the patterns to your actual components.
//  */

// // ============================================================================
// // LEVEL 1: Basic App Setup (Root Layout)
// // ============================================================================

// // app/_layout.tsx

// /*
// import React from 'react';
// import { Stack } from 'expo-router';
// import { IngestionProvider } from '@/context/TransactionIngestion';
// import { useAuth } from '@/context/Auth';

// export default function RootLayout() {
//   const { user } = useAuth();
  
//   // Assuming you have a function to get the current account
//   const accountId = useCurrentAccountId();

//   return (
//     <IngestionProvider 
//       accountId={accountId}
//       initialSettings={{
//         autoDetectionEnabled: true,
//         confidenceThreshold: 0.6,
//         androidSmsEnabled: true,
//         notificationsEnabled: true,
//         autoCategoryEnabled: true,
//         debugMode: false,
//       }}
//     >
//       <Stack>
//         <Stack.Screen name="(tabs)" options={{ headerShown: false }} />
//         <Stack.Screen name="preferences" options={{ title: 'Settings' }} />
//       </Stack>
//     </IngestionProvider>
//   );
// }
// */

// // ============================================================================
// // LEVEL 2: Settings Screen Integration
// // ============================================================================

// /*
// import { useTransactionIngestion } from '@/context/TransactionIngestion';
// import { ScrollView, Switch, View } from 'react-native';

// export function SettingsScreen() {
//   const {
//     settings,
//     updateSettings,
//     confidenceThreshold,
//     setConfidenceThreshold,
//     setSourceEnabled,
//     isInitialized,
//   } = useTransactionIngestion();

//   if (!isInitialized || !settings) {
//     return <LoadingScreen />;
//   }

//   return (
//     <ScrollView>
//       <View>
//         <Label>Enable Auto-Detection</Label>
//         <Switch
//           value={settings.autoDetectionEnabled}
//           onValueChange={(value) =>
//             updateSettings({ autoDetectionEnabled: value })
//           }
//         />
//       </View>

//       <View>
//         <Label>SMS Detection</Label>
//         <Switch
//           value={settings.androidSmsEnabled}
//           onValueChange={(value) => setSourceEnabled('SMS', value)}
//           disabled={!settings.autoDetectionEnabled}
//         />
//       </View>

//       <View>
//         <Label>Notification Detection</Label>
//         <Switch
//           value={settings.notificationsEnabled}
//           onValueChange={(value) => setSourceEnabled('Notification', value)}
//           disabled={!settings.autoDetectionEnabled}
//         />
//       </View>

//       <View>
//         <Label>
//           Confidence Threshold: {Math.round(confidenceThreshold * 100) }%
//         </Label>
//       </View>
//     </ScrollView>
//   );
// }
// */

// // ============================================================================
// // LEVEL 3: Manual Ingestion Component
// // ============================================================================

// /*
// import { TextInput, TouchableOpacity, Alert } from 'react-native';
// import { useState } from 'react';

// export function ManualTransactionEntry() {
//   const { ingestManually } = useTransactionIngestion();
//   const [text, setText] = useState('');
//   const [loading, setLoading] = useState(false);

//   const handleParse = async () => {
//     if (!text.trim()) {
//       Alert.alert('Empty', 'Please enter transaction text');
//       return;
//     }

//     setLoading(true);
//     try {
//       const result = await ingestManually(text);
      
//       if (result.success) {
//         Alert.alert(
//           'Success',
//           `Transaction created with ID: ${result.recordId}`
//         );
//         setText('');
//       } else {
//         Alert.alert('Failed', result.reason || result.error);
//       }
//     } catch (error) {
//       Alert.alert('Error', error.message);
//     } finally {
//       setLoading(false);
//     }
//   };

//   return (
//     <View>
//       <TextInput
//         placeholder="Paste bank message here..."
//         value={text}
//         onChangeText={setText}
//         multiline
//         numberOfLines={6}
//         editable={!loading}
//       />
      
//       <TouchableOpacity
//         onPress={handleParse}
//         disabled={loading}
//       >
//         <Text>{loading ? 'Parsing...' : 'Parse & Create'}</Text>
//       </TouchableOpacity>
//     </View>
//   );
// }
// */

// // ============================================================================
// // LEVEL 4: Advanced Usage - Custom Bank Configuration
// // ============================================================================

// /*
// import { detectionEngine } from '@/lib/transactionDetection';

// export function setupCustomBanks() {
//   detectionEngine.addBankConfig({
//     id: 'mybank_banking',
//     name: 'MyBank',
//     senderIdentifiers: ['9876543210', 'mybank.app'],
//     patterns: [
//       {
//         name: 'mybank_debit_pattern',
//         pattern: /Amount.*₹?([\d,]+)/i,
//         intent: 'Debit',
//         fieldExtraction: [
//           {
//             field: 'amount',
//             extractor: '1',
//             transform: (val: string) => parseFloat(val.replace(/,/g, '')),
//             required: true,
//           },
//         ],
//         minimumConfidence: 0.8,
//         active: true,
//       },
//     ],
//     currency: 'INR',
//     active: true,
//   });
// }
// */

// // ============================================================================
// // LEVEL 5: Advanced Usage - Custom Category Mapping
// // ============================================================================

// /*
// import { classificationEngine } from '@/lib/transactionDetection';

// export function setupCustomCategories() {
//   classificationEngine.addCategoryMapping({
//     keywords: ['petrol', 'fuel', 'gas station'],
//     category: 'Fuel',
//     categoryId: 'fuel',
//     confidence: 0.9,
//   });
// }
// */

// // ============================================================================
// // LEVEL 6: Monitoring and Debugging
// // ============================================================================

// /*
// import { useTransactionIngestion } from '@/context/TransactionIngestion';

// export function DebugPanel() {
//   const { getManager, toggleDebugMode, debugMode } = useTransactionIngestion();

//   const handleShowLogs = async () => {
//     const manager = getManager();
//     if (!manager) return;

//     const persistence = manager.getPersistenceLayer();
//     const logs = await persistence.getIngestionLogs('user-id', 10);
//     console.log('Recent ingestions:', logs);
//   };

//   return (
//     <View>
//       <TouchableOpacity onPress={() => toggleDebugMode()}>
//         <Text>Debug Mode: {debugMode ? 'ON' : 'OFF'}</Text>
//       </TouchableOpacity>
//       <TouchableOpacity onPress={handleShowLogs}>
//         <Text>Show Logs</Text>
//       </TouchableOpacity>
//     </View>
//   );
// }
// */

// // ============================================================================
// // BEST PRACTICES
// // ============================================================================

// /*
// 1. Always initialize the IngestionProvider at app root
// 2. Check isInitialized before using ingestion functions
// 3. Handle both success and failure cases
// 4. Provide user feedback for every action
// 5. Use appropriate confidence thresholds for your use case
// 6. Test with multiple banks and message formats
// 7. Monitor ingestion logs for debugging
// 8. Update bank configs when new patterns emerge
// 9. Respect user privacy settings
// 10. Implement proper error handling and logging
// */


// // ============================================================================
// // LEVEL 2: Settings Screen Integration
// // ============================================================================

// import { useTransactionIngestion } from '@/context/TransactionIngestion';
// import { ScrollView, Switch, View } from 'react-native';

// export function SettingsScreen() {
//   const {
//     settings,
//     updateSettings,
//     confidenceThreshold,
//     setConfidenceThreshold,
//     setSourceEnabled,
//     isInitialized,
//   } = useTransactionIngestion();

//   if (!isInitialized || !settings) {
//     return <LoadingScreen />;
//   }

//   return (
//     <ScrollView>
//       {/* Auto-Detection Master Toggle */}
//       <View>
//         <Label>Enable Auto-Detection</Label>
//         <Switch
//           value={settings.autoDetectionEnabled}
//           onValueChange={(value) =>
//             updateSettings({ autoDetectionEnabled: value })
//           }
//         />
//       </View>

//       {/* Source Toggles */}
//       <View>
//         <Label>SMS Detection</Label>
//         <Switch
//           value={settings.androidSmsEnabled}
//           onValueChange={(value) => setSourceEnabled('SMS', value)}
//           disabled={!settings.autoDetectionEnabled}
//         />
//       </View>

//       <View>
//         <Label>Notification Detection</Label>
//         <Switch
//           value={settings.notificationsEnabled}
//           onValueChange={(value) => setSourceEnabled('Notification', value)}
//           disabled={!settings.autoDetectionEnabled}
//         />
//       </View>

//       {/* Confidence Threshold */}
//       <View>
//         <Label>
//           Confidence Threshold: {Math.round(confidenceThreshold * 100)}%
//         </Label>
//         <ThresholdSlider
//           min={0.2}
//           max={0.9}
//           step={0.1}
//           value={confidenceThreshold}
//           onChange={setConfidenceThreshold}
//         />
//       </View>

//       {/* Auto-Categorization */}
//       <View>
//         <Label>Auto-Categorize Transactions</Label>
//         <Switch
//           value={settings.autoCategoryEnabled}
//           onValueChange={(value) =>
//             updateSettings({ autoCategoryEnabled: value })
//           }
//         />
//       </View>
//     </ScrollView>
//   );
// }

// // ============================================================================
// // LEVEL 3: Manual Ingestion Component
// // ============================================================================

// import { TextInput, TouchableOpacity, Alert } from 'react-native';
// import { useState } from 'react';

// export function ManualTransactionEntry() {
//   const { ingestManually } = useTransactionIngestion();
//   const [text, setText] = useState('');
//   const [loading, setLoading] = useState(false);

//   const handleParse = async () => {
//     if (!text.trim()) {
//       Alert.alert('Empty', 'Please enter transaction text');
//       return;
//     }

//     setLoading(true);
//     try {
//       const result = await ingestManually(text);
      
//       if (result.success) {
//         Alert.alert(
//           'Success',
//           `Transaction created with ID: ${result.recordId}`
//         );
//         setText('');
//       } else {
//         Alert.alert('Failed', result.reason || result.error);
//       }
//     } catch (error) {
//       Alert.alert('Error', error.message);
//     } finally {
//       setLoading(false);
//     }
//   };

//   return (
//     <View>
//       <TextInput
//         placeholder="Paste bank message here..."
//         value={text}
//         onChangeText={setText}
//         multiline
//         numberOfLines={6}
//         editable={!loading}
//       />
      
//       <TouchableOpacity
//         onPress={handleParse}
//         disabled={loading}
//       >
//         <Text>{loading ? 'Parsing...' : 'Parse & Create'}</Text>
//       </TouchableOpacity>
//     </View>
//   );
// }

// // ============================================================================
// // LEVEL 4: Advanced Usage - Custom Bank Configuration
// // ============================================================================

// import { detectionEngine } from '@/lib/transactionDetection';

// export function setupCustomBanks() {
//   // Add a custom bank with specific patterns
//   detectionEngine.addBankConfig({
//     id: 'mybank_banking',
//     name: 'MyBank',
//     senderIdentifiers: ['9876543210', 'mybank.app', 'mybank'],
//     patterns: [
//       {
//         name: 'mybank_debit_pattern',
//         pattern: /Amount\s+₹?([\d,]+(?:\.\d{2})?)\s+(?:debited|withdrawn)/i,
//         intent: 'Debit',
//         fieldExtraction: [
//           {
//             field: 'amount',
//             extractor: '1',
//             transform: (val: string) => parseFloat(val.replace(/,/g, '')),
//             required: true,
//           },
//         ],
//         minimumConfidence: 0.8,
//         active: true,
//       },
//       {
//         name: 'mybank_credit_pattern',
//         pattern: /Amount\s+₹?([\d,]+(?:\.\d{2})?)\s+(?:credited|received)/i,
//         intent: 'Credit',
//         fieldExtraction: [
//           {
//             field: 'amount',
//             extractor: '1',
//             transform: (val: string) => parseFloat(val.replace(/,/g, '')),
//             required: true,
//           },
//         ],
//         minimumConfidence: 0.8,
//         active: true,
//       },
//     ],
//     currency: 'INR',
//     active: true,
//   });
// }

// // ============================================================================
// // LEVEL 5: Advanced Usage - Custom Category Mapping
// // ============================================================================

// import { classificationEngine } from '@/lib/transactionDetection';

// export function setupCustomCategories() {
//   // Add custom category mappings
//   classificationEngine.addCategoryMapping({
//     keywords: ['petrol', 'fuel', 'gas station', 'cng'],
//     category: 'Fuel',
//     categoryId: 'fuel',
//     confidence: 0.9,
//   });

//   classificationEngine.addCategoryMapping({
//     keywords: ['movie', 'cinema', 'ticket', 'film', 'theater'],
//     category: 'Entertainment',
//     categoryId: 'entertainment',
//     confidence: 0.85,
//   });

//   classificationEngine.addCategoryMapping({
//     keywords: ['donation', 'charity', 'ngo', 'fund'],
//     category: 'Donations',
//     categoryId: 'donations',
//     confidence: 0.8,
//   });
// }

// // ============================================================================
// // LEVEL 6: Monitoring and Debugging
// // ============================================================================

// import { useTransactionIngestion } from '@/context/TransactionIngestion';

// export function DebugPanel() {
//   const {
//     getManager,
//     toggleDebugMode,
//     debugMode,
//     settings,
//   } = useTransactionIngestion();

//   const handleShowLogs = async () => {
//     const manager = getManager();
//     if (!manager) return;

//     const persistence = manager.getPersistenceLayer();
//     const logs = await persistence.getIngestionLogs('current-user-id', 10);
    
//     console.log('=== Recent Ingestions ===');
//     logs.forEach(log => {
//       console.log(`
//         Record: ${log.record_id}
//         Source: ${log.source_type}
//         Confidence: ${log.confidence_score}
//         Time: ${log.ingestion_timestamp}
//       `);
//     });
//   };

//   const handleCheckQueueSize = () => {
//     const manager = getManager();
//     const size = manager?.getIngestionService().getQueueSize() || 0;
//     Alert.alert('Queue Size', `${size} messages in queue`);
//   };

//   return (
//     <View>
//       <TouchableOpacity onPress={() => toggleDebugMode()}>
//         <Text>Debug Mode: {debugMode ? 'ON' : 'OFF'}</Text>
//       </TouchableOpacity>

//       <TouchableOpacity onPress={handleShowLogs}>
//         <Text>Show Ingestion Logs</Text>
//       </TouchableOpacity>

//       <TouchableOpacity onPress={handleCheckQueueSize}>
//         <Text>Check Queue Size</Text>
//       </TouchableOpacity>

//       {settings && (
//         <View>
//           <Text>Confidence Threshold: {settings.confidenceThreshold}</Text>
//           <Text>SMS Enabled: {settings.androidSmsEnabled}</Text>
//           <Text>Notifications Enabled: {settings.notificationsEnabled}</Text>
//           <Text>Auto-Categorize: {settings.autoCategoryEnabled}</Text>
//         </View>
//       )}
//     </View>
//   );
// }

// // ============================================================================
// // LEVEL 7: Handling Ingestion Results
// // ============================================================================

// import { IngestionResult } from '@/lib/transactionDetection';

// export async function handleIngestionResult(result: IngestionResult) {
//   if (result.success) {
//     // Transaction was created successfully
//     console.log(`✅ Transaction created: ${result.recordId}`);
    
//     // You can:
//     // - Show success notification
//     showNotification('Transaction Added', 'Tap to review');
    
//     // - Refresh transaction list
//     await refreshTransactionList();
    
//     // - Update dashboard
//     updateDashboard();
    
//   } else {
//     // Ingestion failed
//     console.log(`❌ Ingestion failed: ${result.reason}`);
    
//     // Handle specific error types
//     if (result.reason.includes('Low confidence')) {
//       // Show low-confidence warning
//       showWarning('Low Confidence', 'Please review the detected data');
//     } else if (result.reason.includes('Duplicate')) {
//       // Show duplicate warning
//       showWarning('Duplicate Detected', 'Similar transaction already exists');
//     } else if (result.reason.includes('No transaction detected')) {
//       // Show no-transaction message
//       showInfo('Not a Transaction', 'This message does not contain transaction info');
//     }
//   }
  
//   // Log metadata for analytics
//   logIngestionEvent({
//     success: result.success,
//     reason: result.reason,
//     confidence: result.metadata?.confidence,
//     source: result.metadata?.source,
//   });
// }

// // ============================================================================
// // LEVEL 8: Best Practices
// // ============================================================================

// /**
//  * Best Practices for Transaction Detection Integration
//  * 
//  * 1. Always initialize the IngestionProvider at app root
//  * 2. Check isInitialized before using ingestion functions
//  * 3. Handle both success and failure cases
//  * 4. Provide user feedback for every action
//  * 5. Use appropriate confidence thresholds for your use case
//  * 6. Test with multiple banks and message formats
//  * 7. Monitor ingestion logs for debugging
//  * 8. Update bank configs when new patterns emerge
//  * 9. Respect user privacy settings
//  * 10. Implement proper error handling and logging
//  */

// export const BestPractices = {
//   // Always wait for initialization
//   async waitForInitialization(maxWait = 5000) {
//     const { isInitialized } = useTransactionIngestion();
//     const startTime = Date.now();
    
//     while (!isInitialized && Date.now() - startTime < maxWait) {
//       await new Promise(resolve => setTimeout(resolve, 100));
//     }
    
//     return isInitialized;
//   },

//   // Provide user feedback
//   async ingestWithFeedback(text: string) {
//     const { ingestManually } = useTransactionIngestion();
    
//     showLoading('Processing transaction...');
//     try {
//       const result = await ingestManually(text);
//       hideLoading();
//       handleIngestionResult(result);
//     } catch (error) {
//       hideLoading();
//       showError('Error processing transaction');
//     }
//   },

//   // Batch ingestion with progress
//   async ingestBatchWithProgress(messages: string[]) {
//     const { ingestManually } = useTransactionIngestion();
    
//     for (let i = 0; i < messages.length; i++) {
333333333333333


































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333




































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































//       showProgress(`Processing ${i + 1}/${messages.length}`);
//       const result = await ingestManually(messages[i]);
//       // Handle result
//       await new Promise(resolve => setTimeout(resolve, 100)); // Rate limiting
//     }
    
//     hideProgress();
//   },
// };

// // ============================================================================
// // Export everything for use in your components
// // ============================================================================

// export {
//   SettingsScreen,
//   ManualTransactionEntry,
//   DebugPanel,
// };
33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333